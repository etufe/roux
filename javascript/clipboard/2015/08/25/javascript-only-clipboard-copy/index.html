<!DOCTYPE html><html class=no-js><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Javascript Only Clipboard Copy</title><meta name=description content=""><meta name=viewport content="width=device-width,initial-scale=1"><link rel=apple-touch-icon sizes=57x57 href=/favicon/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/favicon/apple-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/favicon/apple-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/favicon/apple-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/favicon/apple-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/favicon/apple-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/favicon/apple-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/favicon/apple-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/favicon/apple-icon-180x180.png><link rel=icon type=image/png sizes=192x192 href=/favicon/android-icon-192x192.png><link rel=icon type=image/png sizes=32x32 href=/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/favicon/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=/favicon/favicon-16x16.png><link rel=manifest href=/favicon/manifest.json><meta name=msapplication-TileColor content=#ffffff><meta name=msapplication-TileImage content=/ms-icon-144x144.png><meta name=theme-color content=#ffffff><link href="http://fonts.googleapis.com/css?family=Amatic+SC" rel=stylesheet type=text/css><!-- <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" /> --><link rel=stylesheet href=/css/main.29c1.css><script src=/js/head-scripts.d1e4.js></script></head><body><!--[if lt IE 8]>
<p class="browsehappy">
  You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.
</p>
<![endif]--><nav id=mini-nav><a class=row href=http://etufe.com>&#9055; Etufe.com</a> <a class=row href=/feed.xml>&#9873; Subscribe</a></nav><header><nav class=container><a id=logo href="/" alt="EtufÃ© Blog"></a> <a id=subscribe href=/feed.xml alt="RSS Feed"><span class=icon>&#9873;</span>SUBSCRIBE</a> <a id=home href=http://etufe.com alt="RSS Feed"><span class=icon>&#9055;</span>Etufe.com</a><div id=mini-nav-btn><div class=stripe></div><div class=stripe></div><div class=stripe></div></div></nav></header><div id=main-column><div class=page-header><h1 class=page-title>Javascript Only Clipboard Copy</h1><h2 class=page-subtitle>Jesus Christ finally.</h2><span class=date><span>Tuesday, August 25, 2015</span></span><br><hr></div><article class=post><h2 id=a-tiny-bit-of-history>A tiny bit of history</h2><p>HTML and Javascript have never had a way to put data into the user&#39;s clipboard. In 2011 the W3C created a <a href="http://www.w3.org/TR/2011/WD-clipboard-apis-20110412/">Working Draft</a> spec to enable it. Fast forward to 2015 and some basic functionality is finally making it&#39;s way into browsers though the <a href="http://www.w3.org/TR/clipboard-apis/">Clipboard API and events</a> spec is still a working draft.</p><p>Until now the only half decent way of getting at a user&#39;s clipboard on a webpage has been to use a little <a href=https://github.com/mojombo/clippy>flash plugin</a>. (Almost) Gone are the days of having to rely on a bulky plugin to handle such a simple task. Let&#39;s move on.</p><h2 id=a-tiny-little-script>A tiny little script</h2><p>The current implementation uses <a href=https://developer.mozilla.org/en-US/docs/Web/API/document/execCommand>document.execCommand</a> which is a carry over from <a href=https://developer.mozilla.org/en-US/docs/Web/API/Document/designMode>Design Mode</a>. Some browsers have had this functionality for a while but the entire document had to be in design mode for it to work. The W3C has included this functionality in the spec and it is currently the only widely supported method if interacting with the clipboard.</p><p><strong>Caveats:</strong></p><ul><li>All clipboard manipulations must be preformed inside a user generated event like a mouse click.</li><li>All clipboard manipulations must be preformed on actual selections, either user or programmatically set.</li></ul><p><strong>Copy Text from an Existing Input or Textarea</strong>:</p><div class=highlight><pre><code class=language-javascript data-lang=javascript><span class=c1>// Copy all text from an existing input</span>
<span class=kd>function</span> <span class=nx>copyTextFromInput</span><span class=p>(</span><span class=nx>element</span><span class=p>){</span>
  <span class=nx>element</span><span class=p>.</span><span class=nx>select</span><span class=p>();</span> <span class=c1>// Makes a user selection over the entire input</span>
  <span class=nb>document</span><span class=p>.</span><span class=nx>execCommand</span><span class=p>(</span><span class=s1>&#39;copy&#39;</span><span class=p>)</span>
<span class=p>}</span>

<span class=c1>// Copy just the user selection</span>
<span class=kd>function</span> <span class=nx>copyUserSelectionFromInput</span><span class=p>(</span><span class=nx>element</span><span class=p>){</span>
  <span class=nx>element</span><span class=p>.</span><span class=nx>focus</span><span class=p>();</span> <span class=c1>// We simply need to re-focus the element</span>
  <span class=nb>document</span><span class=p>.</span><span class=nx>execCommand</span><span class=p>(</span><span class=s1>&#39;copy&#39;</span><span class=p>);</span>
<span class=p>}</span></code></pre></div><p><strong>Copy Arbitrary Text</strong></p><div class=highlight><pre><code class=language-javascript data-lang=javascript><span class=c1>// Copy arbitrary text by placing it in a textarea, and copying it;</span>
<span class=kd>function</span> <span class=nx>copyText</span><span class=p>(</span><span class=nx>text</span><span class=p>){</span>
  <span class=c1>// Create a textarea for the text to reside</span>
  <span class=kd>var</span> <span class=nx>ta</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s1>&#39;textarea&#39;</span><span class=p>);</span>
  <span class=c1>// Hide it from display</span>
  <span class=nx>ta</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>position</span> <span class=o>=</span> <span class=s2>&quot;fixed&quot;</span><span class=p>;</span>
  <span class=nx>ta</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>top</span> <span class=o>=</span> <span class=nx>ta</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>left</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
  <span class=nx>ta</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>opacity</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
  <span class=c1>// Set the text</span>
  <span class=nx>ta</span><span class=p>.</span><span class=nx>value</span> <span class=o>=</span> <span class=nx>text</span><span class=p>;</span>
  <span class=c1>// Add it to the document</span>
  <span class=nb>document</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>ta</span><span class=p>);</span>
  <span class=c1>// Make a user selection on it&#39;s contents</span>
  <span class=nx>ta</span><span class=p>.</span><span class=nx>select</span><span class=p>();</span>
  <span class=c1>// Preform the copy</span>
  <span class=nb>document</span><span class=p>.</span><span class=nx>execCommand</span><span class=p>(</span><span class=s1>&#39;copy&#39;</span><span class=p>);</span>
  <span class=c1>// Remove the element</span>
  <span class=nx>ta</span><span class=p>.</span><span class=nx>remove</span><span class=p>();</span>
<span class=p>}</span></code></pre></div><h3 id=bonus:-cut>Bonus: Cut</h3><p>These should all also work for &quot;cut&quot; though cutting arbitrary text doesn&#39;t make much sense.</p><h3 id=bonus-2:-paste>Bonus 2: Paste</h3><p>In order to get paste to work it should be as simple as:</p><div class=highlight><pre><code class=language-javascript data-lang=javascript><span class=kd>function</span> <span class=nx>pasteClipboardToElement</span><span class=p>(</span><span class=nx>element</span><span class=p>){</span>
  <span class=nx>element</span><span class=p>.</span><span class=nx>focus</span><span class=p>();</span>
  <span class=nb>document</span><span class=p>.</span><span class=nx>execCommand</span><span class=p>(</span><span class=s1>&#39;paste&#39;</span><span class=p>);</span>
<span class=p>}</span></code></pre></div><p>Though support is non-existent.</p><h3 id=working-demo>Working Demo</h3><p><a href=http://output.jsbin.com/muhiqu/?output>http://output.jsbin.com/muhiqu/?output</a></p><h2 id=testing-for-functionality>Testing for functionality</h2><p>According to the spec and, luckily, how it&#39;s implemented in browsers is that if <code>document.execCommand(&quot;command&quot;)</code> returns <code>true</code> then the functionality for <code>&quot;command&quot;</code> must be implemented. Unfortunately, in Firefox this throws an error if called at certain times. So to check if a browser supports the <code>&quot;copy&quot;</code> command, or any other command for that matter, you just need to run:</p><div class=highlight><pre><code class=language-javascript data-lang=javascript><span class=c1>// This checks if javascript clipboard copy is supported</span>
<span class=kd>function</span> <span class=nx>supportsCommand</span><span class=p>(</span><span class=nx>command</span><span class=p>){</span>
  <span class=k>try</span><span class=p>{</span>
    <span class=k>return</span> <span class=nb>document</span><span class=p>.</span><span class=nx>execCommand</span><span class=p>(</span><span class=nx>command</span><span class=p>)</span> <span class=o>===</span> <span class=kc>true</span><span class=p>;</span>
  <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>er</span><span class=p>){</span>
    <span class=k>return</span> <span class=kc>false</span><span class=p>;</span>
  <span class=p>}</span>
<span class=p>}</span></code></pre></div><h2 id=browser-support>Browser Support</h2><p>For a current and detailed breakdown check <a href="http://caniuse.com/#feat=clipboard">Can I Use</a>. Modern Chrome, Opera, and IE are all supported. We get Firefox support with version 41 coming out next month. As of mid September 2015, every major browser will support Javascript only clipboard copy except desktop and mobile safari. Thus further commiting Safari as <a href="http://nolanlawson.com/2015/06/30/safari-is-the-new-ie/">becoming the new IE</a>.</p><!-- Refs --></article><div class=page-footer><h4>Another fine kettle of fish from the good folks at <i>EtufÃ©</i>.</h4></div></div><footer><a href="http://creativecommons.org/licenses/by-sa/4.0/">CC-BY-SA-4.0</a> 2015 &#9884; EtufÃ©</footer><script src=//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js></script><script>window.jQuery || document.write('<script src="/_bower_components/jquery/jquery.min.js"><\/script>')</script><script src=/js/script.787e.js></script><script>var clicky_site_ids = clicky_site_ids || [];
  clicky_site_ids.push(100824795);</script><script src=//static.getclicky.com/js></script></body></html>